!function e(t,n,r){function o(a,s){if(!n[a]){if(!t[a]){var u="function"==typeof require&&require;if(!s&&u)return u(a,!0);if(i)return i(a,!0);var c=new Error("Cannot find module '"+a+"'");throw c.code="MODULE_NOT_FOUND",c}var f=n[a]={exports:{}};t[a][0].call(f.exports,(function(e){return o(t[a][1][e]||e)}),f,f.exports,e,t,n,r)}return n[a].exports}for(var i="function"==typeof require&&require,a=0;a<r.length;a++)o(r[a]);return o}({1:[function(e,t,n){var r=e("clamp");t.exports=function(e,t,n){var o=Math.round(e/(t/2)*n);return r(o,0,n)}},{clamp:14}],2:[function(e,t,n){var r=e("./mime-types.json"),o={};Object.keys(r).forEach((function(e){r[e].forEach((function(t){o[t]=e}))})),t.exports=function(e){if(!e)throw new TypeError("must specify extension string");return 0===e.indexOf(".")&&(e=e.substring(1)),o[e.toLowerCase()]}},{"./mime-types.json":3}],3:[function(e,t,n){t.exports={"audio/midi":["mid","midi","kar","rmi"],"audio/mp4":["mp4a","m4a"],"audio/mpeg":["mpga","mp2","mp2a","mp3","m2a","m3a"],"audio/ogg":["oga","ogg","spx"],"audio/webm":["weba"],"audio/x-matroska":["mka"],"audio/x-mpegurl":["m3u"],"audio/wav":["wav"],"video/3gpp":["3gp"],"video/3gpp2":["3g2"],"video/mp4":["mp4","mp4v","mpg4"],"video/mpeg":["mpeg","mpg","mpe","m1v","m2v"],"video/ogg":["ogv"],"video/quicktime":["qt","mov"],"video/webm":["webm"],"video/x-f4v":["f4v"],"video/x-fli":["fli"],"video/x-flv":["flv"],"video/x-m4v":["m4v"],"video/x-matroska":["mkv","mk3d","mks"]}},{}],4:[function(e,t,n){var r=e("./lib/css-color"),o=e("./lib/css-color-names.json"),i=e("./lib/relative-luminance"),a=e("./lib/hsl"),s=e("./lib/hex-to-rgba"),u=e("./lib/rgba-to-hex");t.exports.parse=r.parse,t.exports.style=r.style,t.exports.names=o,t.exports.relativeLuminance=function(e){var n=t.exports.parse(e);return n?i(n.rgb):null},t.exports.contrastRatio=function(e,n){var r=t.exports.relativeLuminance(e),o=t.exports.relativeLuminance(n);return null==r||null==o?null:(Math.max(r,o)+.05)/(Math.min(r,o)+.05)},t.exports.offsetHSL=function(e,n,r,o){var i=t.exports.parse(e);return i?(i.hsla[0]+=n||0,i.hsla[1]=Math.max(0,Math.min(100,i.hsla[1]+(r||0))),i.hsla[2]=Math.max(0,Math.min(100,i.hsla[2]+(o||0))),t.exports.parse({hsla:i.hsla})):null},t.exports.blend=function(e,n,r){var o=t.exports.parse(e),i=t.exports.parse(n);if(null==o||null==i)return null;var a=o.rgba,s=i.rgba,u=(r="number"==typeof r&&isFinite(r)?r:1)*s[3];if(u>=1)return i;for(var c=0;c<3;c++)s[c]=s[c]*u+a[c]*(a[3]*(1-u));return s[3]=Math.max(0,Math.min(1,u+a[3]*(1-u))),t.exports.parse(s)},t.exports.hexToRGBA=s,t.exports.RGBAToHex=u,t.exports.RGBAToHSLA=a.RGBAToHSLA,t.exports.HSLAToRGBA=a.HSLAToRGBA},{"./lib/css-color":6,"./lib/css-color-names.json":5,"./lib/hex-to-rgba":7,"./lib/hsl":8,"./lib/relative-luminance":9,"./lib/rgba-to-hex":10}],5:[function(e,t,n){t.exports={aliceblue:"#f0f8ff",antiquewhite:"#faebd7",aqua:"#00ffff",aquamarine:"#7fffd4",azure:"#f0ffff",beige:"#f5f5dc",bisque:"#ffe4c4",black:"#000000",blanchedalmond:"#ffebcd",blue:"#0000ff",blueviolet:"#8a2be2",brown:"#a52a2a",burlywood:"#deb887",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",cornflowerblue:"#6495ed",cornsilk:"#fff8dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkgray:"#a9a9a9",darkgreen:"#006400",darkgrey:"#a9a9a9",darkkhaki:"#bdb76b",darkmagenta:"#8b008b",darkolivegreen:"#556b2f",darkorange:"#ff8c00",darkorchid:"#9932cc",darkred:"#8b0000",darksalmon:"#e9967a",darkseagreen:"#8fbc8f",darkslateblue:"#483d8b",darkslategray:"#2f4f4f",darkslategrey:"#2f4f4f",darkturquoise:"#00ced1",darkviolet:"#9400d3",deeppink:"#ff1493",deepskyblue:"#00bfff",dimgray:"#696969",dimgrey:"#696969",dodgerblue:"#1e90ff",firebrick:"#b22222",floralwhite:"#fffaf0",forestgreen:"#228b22",fuchsia:"#ff00ff",gainsboro:"#dcdcdc",ghostwhite:"#f8f8ff",gold:"#ffd700",goldenrod:"#daa520",gray:"#808080",green:"#008000",greenyellow:"#adff2f",grey:"#808080",honeydew:"#f0fff0",hotpink:"#ff69b4",indianred:"#cd5c5c",indigo:"#4b0082",ivory:"#fffff0",khaki:"#f0e68c",lavender:"#e6e6fa",lavenderblush:"#fff0f5",lawngreen:"#7cfc00",lemonchiffon:"#fffacd",lightblue:"#add8e6",lightcoral:"#f08080",lightcyan:"#e0ffff",lightgoldenrodyellow:"#fafad2",lightgray:"#d3d3d3",lightgreen:"#90ee90",lightgrey:"#d3d3d3",lightpink:"#ffb6c1",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",lightskyblue:"#87cefa",lightslategray:"#778899",lightslategrey:"#778899",lightsteelblue:"#b0c4de",lightyellow:"#ffffe0",lime:"#00ff00",limegreen:"#32cd32",linen:"#faf0e6",magenta:"#ff00ff",maroon:"#800000",mediumaquamarine:"#66cdaa",mediumblue:"#0000cd",mediumorchid:"#ba55d3",mediumpurple:"#9370db",mediumseagreen:"#3cb371",mediumslateblue:"#7b68ee",mediumspringgreen:"#00fa9a",mediumturquoise:"#48d1cc",mediumvioletred:"#c71585",midnightblue:"#191970",mintcream:"#f5fffa",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",navajowhite:"#ffdead",navy:"#000080",oldlace:"#fdf5e6",olive:"#808000",olivedrab:"#6b8e23",orange:"#ffa500",orangered:"#ff4500",orchid:"#da70d6",palegoldenrod:"#eee8aa",palegreen:"#98fb98",paleturquoise:"#afeeee",palevioletred:"#db7093",papayawhip:"#ffefd5",peachpuff:"#ffdab9",peru:"#cd853f",pink:"#ffc0cb",plum:"#dda0dd",powderblue:"#b0e0e6",purple:"#800080",rebeccapurple:"#663399",red:"#ff0000",rosybrown:"#bc8f8f",royalblue:"#4169e1",saddlebrown:"#8b4513",salmon:"#fa8072",sandybrown:"#f4a460",seagreen:"#2e8b57",seashell:"#fff5ee",sienna:"#a0522d",silver:"#c0c0c0",skyblue:"#87ceeb",slateblue:"#6a5acd",slategray:"#708090",slategrey:"#708090",snow:"#fffafa",springgreen:"#00ff7f",steelblue:"#4682b4",tan:"#d2b48c",teal:"#008080",thistle:"#d8bfd8",tomato:"#ff6347",turquoise:"#40e0d0",violet:"#ee82ee",wheat:"#f5deb3",white:"#ffffff",whitesmoke:"#f5f5f5",yellow:"#ffff00",yellowgreen:"#9acd32"}},{}],6:[function(e,t,n){var r=e("./css-color-names.json"),o=e("./hsl"),i=e("./hex-to-rgba"),a=e("./rgba-to-hex"),s=e("./wrap");function u(e){if("string"!=typeof e)throw new TypeError("Color parsing must be performed on a string parameter");var t,n,u;if((e=e.toLowerCase())in r?e=r[e]:"transparent"===e&&(e="#00000000"),/^#[a-f0-9]+$/.test(e))t=i(e),u=a(t),n=o.RGBAToHSLA(t);else{var c=/^((?:rgb|hsl)a?)\s*\(([^)]*)\)/.exec(e);if(!c)return null;var f=c[1].replace(/a$/,""),l=c[2].replace(/^\s+|\s+$/g,"").split(/\s*,\s*/).map((function(e,t){return t<=2?Math.round(parseFloat(e)||0):("number"==typeof(e=parseFloat(e))&&isFinite(e)||(e=1),e)}));void 0!==l[3]&&isFinite(l[3])||(l[3]=1),"rgb"===f?(n=o.RGBAToHSLA(l),t=l):"hsl"===f&&(t=o.HSLAToRGBA(l),l[0]=s(l[0],0,360),n=l),u=a(t)}return t||u||n?{hex:u,alpha:t[3],rgb:t.slice(0,3),rgba:t,hsl:n.slice(0,3),hsla:n}:null}function c(e,t,n,r){return e=Math.max(0,Math.min(255,Math.round(e))),t=Math.max(0,Math.min(255,Math.round(t))),n=Math.max(0,Math.min(255,Math.round(n))),1!==r&&isFinite(r)&&void 0!==r?"rgba("+[e,t,n,r=Math.max(0,Math.min(1,r))].join(", ")+")":"rgb("+[e,t,n].join(", ")+")"}function f(e,t,n,r){return e=s(e,0,360),e=Math.max(0,Math.min(360,Math.round(e))),t=Math.max(0,Math.min(100,Math.round(t))),n=Math.max(0,Math.min(100,Math.round(n))),1!==r&&isFinite(r)&&void 0!==r?"hsla("+[e,t,n,r=Math.max(0,Math.min(1,r))].join(", ")+")":"hsl("+[e,t,n].join(", ")+")"}t.exports.parse=function(e){if("string"==typeof e)return u(e);var t;if(Array.isArray(e)&&e.length>=3)return u(c(e[0],e[1],e[2],e[3]));if(e&&"object"==typeof e&&(e.hex?t=e.hex:e.rgba?t=c(e.rgba[0],e.rgba[1],e.rgba[2],e.rgba[3]):e.hsla?t=f(e.hsla[0],e.hsla[1],e.hsla[2],e.hsla[3]):e.rgb?t=c(e.rgb[0],e.rgb[1],e.rgb[2]):e.hsl&&(t=f(e.hsl[0],e.hsl[1],e.hsl[2])),t))return u(t);return null},t.exports.style=function(e){var n=t.exports.parse(e);if(n){var r=n.rgba;return c(r[0],r[1],r[2],r[3])}return null}},{"./css-color-names.json":5,"./hex-to-rgba":7,"./hsl":8,"./rgba-to-hex":10,"./wrap":11}],7:[function(e,t,n){t.exports=function(e){if("string"!=typeof e)throw new TypeError("Hex code parsing must be performed on a string parameter");if(e=e.toLowerCase(),!/^#[a-f0-9]+$/.test(e))return null;var t=e.replace(/^#/,""),n=1;8===t.length&&(n=parseInt(t.slice(6,8),16)/255,t=t.slice(0,6));4===t.length&&(n=parseInt(t.slice(3,4).repeat(2),16)/255,t=t.slice(0,3));3===t.length&&(t=t[0]+t[0]+t[1]+t[1]+t[2]+t[2]);var r=parseInt(t,16);return[r>>16,r>>8&255,255&r,n]}},{}],8:[function(e,t,n){var r=e("float-hsl2rgb"),o=e("float-rgb2hsl"),i=e("./wrap");t.exports.RGBAToHSLA=function(e){var t=o([e[0]/255,e[1]/255,e[2]/255]);return[Math.max(0,Math.min(360,Math.round(360*t[0]))),Math.max(0,Math.min(100,Math.round(100*t[1]))),Math.max(0,Math.min(100,Math.round(100*t[2]))),e[3]]},t.exports.HSLAToRGBA=function(e){var t=i(e[0],0,360),n=r([t/360,e[1]/100,e[2]/100]);return[Math.max(0,Math.min(255,Math.round(255*n[0]))),Math.max(0,Math.min(255,Math.round(255*n[1]))),Math.max(0,Math.min(255,Math.round(255*n[2]))),e[3]]}},{"./wrap":11,"float-hsl2rgb":16,"float-rgb2hsl":17}],9:[function(e,t,n){var r=1/12.92;function o(e){return Math.pow((e+.055)/1.055,2.4)}t.exports=function(e){var t=e[0]/255,n=e[1]/255,i=e[2]/255,a=t<=.03928?t*r:o(t),s=n<=.03928?n*r:o(n),u=i<=.03928?i*r:o(i);return.2126*a+.7152*s+.0722*u}},{}],10:[function(e,t,n){t.exports=function(e){if(!e||!Array.isArray(e))throw new TypeError("Must specify an array to convert into a hex code");var t=Math.max(0,Math.min(255,Math.round(e[0]||0))),n=Math.max(0,Math.min(255,Math.round(e[1]||0))),r=Math.max(0,Math.min(255,Math.round(e[2]||0))),o=e[3];void 0!==o&&isFinite(o)||(o=1);var i=Math.max(0,Math.min(255,Math.round(255*o))),a=255===i?"":(256|i).toString(16).slice(1);return"#"+((r|n<<8|t<<16|1<<24).toString(16).slice(1)+a)}},{}],11:[function(e,t,n){t.exports=function(e,t,n){if("number"!=typeof t||"number"!=typeof n)throw new TypeError('Must specify "to" and "from" arguments as numbers');if(t>n){var r=t;t=n,n=r}var o=n-t;if(0===o)return n;return e-o*Math.floor((e-t)/o)}},{}],12:[function(e,t,n){var r=e("defined"),o=e("./lib/wrap"),i=Number.EPSILON;function a(e,t,n){return t<n?e<t?t:e>n?n:e:e<n?n:e>t?t:e}function s(e,t,n){return e*(1-n)+t*n}function u(e,t,n){return Math.abs(e-t)<i?0:(n-e)/(t-e)}function c(e,t){return t=r(t,0),"number"==typeof e&&isFinite(e)?e:t}function f(e){if("number"!=typeof e)throw new TypeError("Expected dims argument");return function(t,n){var o;n=r(n,0),null==t?o=n:"number"==typeof t&&isFinite(t)&&(o=t);var i,a=[];if(null==o)for(i=0;i<e;i++)a[i]=c(t[i],n);else for(i=0;i<e;i++)a[i]=o;return a}}function l(e,t,n,r){if(r=r||[],e.length!==t.length)throw new TypeError("min and max array are expected to have the same length");for(var o=0;o<e.length;o++)r[o]=s(e[o],t[o],n);return r}function p(e,t){if("number"!=typeof(e=r(e,0)))throw new TypeError("Expected n argument to be a number");for(var n=[],o=0;o<e;o++)n.push(t);return n}function d(e,t){return(e%t+t)%t}function h(e,t,n,r){return s(e,t,1-Math.exp(-n*r))}t.exports={mod:d,fract:function(e){return e-Math.floor(e)},sign:function(e){return e>0?1:e<0?-1:0},degToRad:function(e){return e*Math.PI/180},radToDeg:function(e){return 180*e/Math.PI},wrap:o,pingPong:function(e,t){return e=d(e,2*t),t-Math.abs(e-t)},linspace:function(e,t){if("number"!=typeof(e=r(e,0)))throw new TypeError("Expected n argument to be a number");"boolean"==typeof(t=t||{})&&(t={endpoint:!0});var n=r(t.offset,0);return t.endpoint?p(e).map((function(t,r){return e<=1?0:(r+n)/(e-1)})):p(e).map((function(t,r){return(r+n)/e}))},lerp:s,lerpArray:l,inverseLerp:u,lerpFrames:function(e,t,n){t=a(t,0,1);var r=e.length-1,o=t*r,i=Math.floor(o),u=o-i,c=Math.min(i+1,r),f=e[i%e.length],p=e[c%e.length];if("number"==typeof f&&"number"==typeof p)return s(f,p,u);if(Array.isArray(f)&&Array.isArray(p))return l(f,p,u,n);throw new TypeError("Mismatch in value type of two array elements: "+i+" and "+c)},clamp:a,clamp01:function(e){return a(e,0,1)},smoothstep:function(e,t,n){var r=a(u(e,t,n),0,1);return r*r*(3-2*r)},damp:h,dampArray:function(e,t,n,r,o){o=o||[];for(var i=0;i<e.length;i++)o[i]=h(e[i],t[i],n,r);return o},mapRange:function(e,t,n,r,o,a){if(Math.abs(t-n)<i)return r;var s=(e-t)/(n-t)*(o-r)+r;return a&&(o<r?s<o?s=o:s>r&&(s=r):s>o?s=o:s<r&&(s=r)),s},expand2D:f(2),expand3D:f(3),expand4D:f(4)}},{"./lib/wrap":11,defined:15}],13:[function(e,t,n){(function(e){(function(){!function(e,r){"object"==typeof n&&void 0!==t?t.exports=r():"function"==typeof define&&define.amd?define(r):e.canvasSketch=r()}(this,(function(){var t=Object.getOwnPropertySymbols,n=Object.prototype.hasOwnProperty,r=Object.prototype.propertyIsEnumerable;var o=function(){try{if(!Object.assign)return!1;var e=new String("abc");if(e[5]="de","5"===Object.getOwnPropertyNames(e)[0])return!1;for(var t={},n=0;n<10;n++)t["_"+String.fromCharCode(n)]=n;if("0123456789"!==Object.getOwnPropertyNames(t).map((function(e){return t[e]})).join(""))return!1;var r={};return"abcdefghijklmnopqrst".split("").forEach((function(e){r[e]=e})),"abcdefghijklmnopqrst"===Object.keys(Object.assign({},r)).join("")}catch(e){return!1}}()?Object.assign:function(e,o){for(var i,a,s=function(e){if(null==e)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(e)}(e),u=1;u<arguments.length;u++){for(var c in i=Object(arguments[u]))n.call(i,c)&&(s[c]=i[c]);if(t){a=t(i);for(var f=0;f<a.length;f++)r.call(i,a[f])&&(s[a[f]]=i[a[f]])}}return s},i="undefined"!=typeof window?window:void 0!==e?e:"undefined"!=typeof self?self:{};function a(e,t){return e(t={exports:{}},t.exports),t.exports}var s=i.performance&&i.performance.now?function(){return performance.now()}:Date.now||function(){return+new Date},u=function(e){return!!e&&("object"==typeof e||"function"==typeof e)&&"function"==typeof e.then};var c=function(e){return!(!e||"object"!=typeof e)&&("object"==typeof window&&"object"==typeof window.Node?e instanceof window.Node:"number"==typeof e.nodeType&&"string"==typeof e.nodeName)};function f(){return"undefined"!=typeof window&&window["canvas-sketch-cli"]}function l(){for(var e=arguments,t=0;t<arguments.length;t++)if(null!=e[t])return e[t]}function p(){return"undefined"!=typeof document}function d(e){return e&&"function"==typeof e.save&&"function"==typeof e.scale&&"function"==typeof e.restore}var h,m=a((function(e,t){function n(e){var t=[];for(var n in e)t.push(n);return t}(e.exports="function"==typeof Object.keys?Object.keys:n).shim=n})),g=a((function(e,t){var n="[object Arguments]"==function(){return Object.prototype.toString.call(arguments)}();function r(e){return"[object Arguments]"==Object.prototype.toString.call(e)}function o(e){return e&&"object"==typeof e&&"number"==typeof e.length&&Object.prototype.hasOwnProperty.call(e,"callee")&&!Object.prototype.propertyIsEnumerable.call(e,"callee")||!1}(t=e.exports=n?r:o).supported=r,t.unsupported=o})),y=a((function(e){var t=Array.prototype.slice,n=e.exports=function(e,i,a){return a||(a={}),e===i||(e instanceof Date&&i instanceof Date?e.getTime()===i.getTime():!e||!i||"object"!=typeof e&&"object"!=typeof i?a.strict?e===i:e==i:function(e,i,a){var s,u;if(r(e)||r(i))return!1;if(e.prototype!==i.prototype)return!1;if(g(e))return!!g(i)&&(e=t.call(e),i=t.call(i),n(e,i,a));if(o(e)){if(!o(i))return!1;if(e.length!==i.length)return!1;for(s=0;s<e.length;s++)if(e[s]!==i[s])return!1;return!0}try{var c=m(e),f=m(i)}catch(e){return!1}if(c.length!=f.length)return!1;for(c.sort(),f.sort(),s=c.length-1;s>=0;s--)if(c[s]!=f[s])return!1;for(s=c.length-1;s>=0;s--)if(!n(e[u=c[s]],i[u],a))return!1;return typeof e==typeof i}(e,i,a))};function r(e){return null==e}function o(e){return!(!e||"object"!=typeof e||"number"!=typeof e.length)&&("function"==typeof e.copy&&"function"==typeof e.slice&&!(e.length>0&&"number"!=typeof e[0]))}})),v=a((function(e,t){!function(t){var n,r,o,i=(n=/d{1,4}|m{1,4}|yy(?:yy)?|([HhMsTt])\1?|[LloSZWN]|"[^"]*"|'[^']*'/g,r=/\b(?:[PMCEA][SDP]T|(?:Pacific|Mountain|Central|Eastern|Atlantic) (?:Standard|Daylight|Prevailing) Time|(?:GMT|UTC)(?:[-+]\d{4})?)\b/g,o=/[^-+\dA-Z]/g,function(e,t,s,u){if(1!==arguments.length||"string"!==(null===(c=e)?"null":void 0===c?"undefined":"object"!=typeof c?typeof c:Array.isArray(c)?"array":{}.toString.call(c).slice(8,-1).toLowerCase())||/\d/.test(e)||(t=e,e=void 0),(e=e||new Date)instanceof Date||(e=new Date(e)),isNaN(e))throw TypeError("Invalid date");var c,f=(t=String(i.masks[t]||t||i.masks.default)).slice(0,4);"UTC:"!==f&&"GMT:"!==f||(t=t.slice(4),s=!0,"GMT:"===f&&(u=!0));var l=s?"getUTC":"get",p=e[l+"Date"](),d=e[l+"Day"](),h=e[l+"Month"](),m=e[l+"FullYear"](),g=e[l+"Hours"](),y=e[l+"Minutes"](),v=e[l+"Seconds"](),b=e[l+"Milliseconds"](),w=s?0:e.getTimezoneOffset(),x=function(e){var t=new Date(e.getFullYear(),e.getMonth(),e.getDate());t.setDate(t.getDate()-(t.getDay()+6)%7+3);var n=new Date(t.getFullYear(),0,4);n.setDate(n.getDate()-(n.getDay()+6)%7+3);var r=t.getTimezoneOffset()-n.getTimezoneOffset();return t.setHours(t.getHours()-r),1+Math.floor((t-n)/6048e5)}(e),M=function(e){var t=e.getDay();return 0===t&&(t=7),t}(e),k={d:p,dd:a(p),ddd:i.i18n.dayNames[d],dddd:i.i18n.dayNames[d+7],m:h+1,mm:a(h+1),mmm:i.i18n.monthNames[h],mmmm:i.i18n.monthNames[h+12],yy:String(m).slice(2),yyyy:m,h:g%12||12,hh:a(g%12||12),H:g,HH:a(g),M:y,MM:a(y),s:v,ss:a(v),l:a(b,3),L:a(Math.round(b/10)),t:g<12?i.i18n.timeNames[0]:i.i18n.timeNames[1],tt:g<12?i.i18n.timeNames[2]:i.i18n.timeNames[3],T:g<12?i.i18n.timeNames[4]:i.i18n.timeNames[5],TT:g<12?i.i18n.timeNames[6]:i.i18n.timeNames[7],Z:u?"GMT":s?"UTC":(String(e).match(r)||[""]).pop().replace(o,""),o:(w>0?"-":"+")+a(100*Math.floor(Math.abs(w)/60)+Math.abs(w)%60,4),S:["th","st","nd","rd"][p%10>3?0:(p%100-p%10!=10)*p%10],W:x,N:M};return t.replace(n,(function(e){return e in k?k[e]:e.slice(1,e.length-1)}))});function a(e,t){for(e=String(e),t=t||2;e.length<t;)e="0"+e;return e}i.masks={default:"ddd mmm dd yyyy HH:MM:ss",shortDate:"m/d/yy",mediumDate:"mmm d, yyyy",longDate:"mmmm d, yyyy",fullDate:"dddd, mmmm d, yyyy",shortTime:"h:MM TT",mediumTime:"h:MM:ss TT",longTime:"h:MM:ss TT Z",isoDate:"yyyy-mm-dd",isoTime:"HH:MM:ss",isoDateTime:"yyyy-mm-dd'T'HH:MM:sso",isoUtcDateTime:"UTC:yyyy-mm-dd'T'HH:MM:ss'Z'",expiresHeaderFormat:"ddd, dd mmm yyyy HH:MM:ss Z"},i.i18n={dayNames:["Sun","Mon","Tue","Wed","Thu","Fri","Sat","Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],monthNames:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec","January","February","March","April","May","June","July","August","September","October","November","December"],timeNames:["a","p","am","pm","A","P","AM","PM"]},e.exports=i}()})),b="",w=function(e,t){if("string"!=typeof e)throw new TypeError("expected a string");if(1===t)return e;if(2===t)return e+e;var n=e.length*t;if(h!==e||void 0===h)h=e,b="";else if(b.length>=n)return b.substr(0,n);for(;n>b.length&&t>1;)1&t&&(b+=e),t>>=1,e+=e;return b=(b+=e).substr(0,n)};var x,M=function(e,t,n){return e=e.toString(),void 0===t?e:(n=0===n?"0":n?n.toString():" ",w(n,t-e.length)+e)},k=function(){},_={extension:"",prefix:"",suffix:""},T=["image/png","image/jpeg","image/webp"];function E(e,t){return void 0===t&&(t={}),new Promise((function(n,r){t=o({},_,t);var i=P(Object.assign({},t,{extension:"",frame:void 0})),a=e?"streamStart":"streamEnd",s=f();return s&&s.output&&"function"==typeof s[a]?s[a](o({},t,{filename:i})).then((function(e){return n(e)})):n({filename:i,client:!1})}))}function j(e,t){return void 0===t&&(t={}),function(e){return new Promise((function(t){var n=e.indexOf(",");if(-1!==n){for(var r=e.slice(n+1),o=window.atob(r),i=e.slice(0,n),a=/data:([^;]+)/.exec(i),s=(a?a[1]:"")||void 0,u=new ArrayBuffer(o.length),c=new Uint8Array(u),f=0;f<o.length;f++)c[f]=o.charCodeAt(f);t(new window.Blob([u],{type:s}))}else t(new window.Blob)}))}(e).then((function(e){return R(e,t)}))}function R(e,t){return void 0===t&&(t={}),new Promise((function(n){var r=(t=o({},_,t)).filename,i=f();if(i&&"function"==typeof i.saveBlob&&i.output)return i.saveBlob(e,o({},t,{filename:r})).then((function(e){return n(e)}));x||((x=document.createElement("a")).style.visibility="hidden",x.target="_blank"),x.download=r,x.href=window.URL.createObjectURL(e),document.body.appendChild(x),x.onclick=function(){x.onclick=k,setTimeout((function(){window.URL.revokeObjectURL(e),x.parentElement&&x.parentElement.removeChild(x),x.removeAttribute("href"),n({filename:r,client:!1})}))},x.click()}))}function P(e){if(void 0===e&&(e={}),"function"==typeof(e=o({},e)).file)return e.file(e);if(e.file)return e.file;var t,n=null,r="";("string"==typeof e.extension&&(r=e.extension),"number"==typeof e.frame)&&(t="number"==typeof e.totalFrames?e.totalFrames:Math.max(1e4,e.frame),n=M(String(e.frame),String(t).length,"0"));var i=isFinite(e.totalLayers)&&isFinite(e.layer)&&e.totalLayers>1?""+e.layer:"";return null!=n?[i,n].filter(Boolean).join("-")+r:[e.prefix,e.name||e.timeStamp,i,e.hash,e.suffix].filter(Boolean).join("-")+r}var O={dimension:"dimensions",animated:"animate",animating:"animate",unit:"units",P5:"p5",pixellated:"pixelated",looping:"loop",pixelPerInch:"pixels"},S=["dimensions","units","pixelsPerInch","orientation","scaleToFit","scaleToView","bleed","pixelRatio","exportPixelRatio","maxPixelRatio","scaleContext","resizeCanvas","styleCanvas","canvas","context","attributes","parent","file","name","prefix","suffix","animate","playing","loop","duration","totalFrames","fps","playbackRate","timeScale","frame","time","flush","pixelated","hotkeys","p5","id","scaleToFitPadding","data","params","encoding","encodingQuality"],C=function(e){Object.keys(e).forEach((function(e){e in O?console.warn('[canvas-sketch] Could not recognize the setting "'+e+'", did you mean "'+O[e]+'"?'):S.includes(e)||console.warn('[canvas-sketch] Could not recognize the setting "'+e+'"')}))};var A=[["postcard",101.6,152.4],["poster-small",280,430],["poster",460,610],["poster-large",610,910],["business-card",50.8,88.9],["2r",64,89],["3r",89,127],["4r",102,152],["5r",127,178],["6r",152,203],["8r",203,254],["10r",254,305],["11r",279,356],["12r",305,381],["a0",841,1189],["a1",594,841],["a2",420,594],["a3",297,420],["a4",210,297],["a5",148,210],["a6",105,148],["a7",74,105],["a8",52,74],["a9",37,52],["a10",26,37],["2a0",1189,1682],["4a0",1682,2378],["b0",1e3,1414],["b1",707,1e3],["b1+",720,1020],["b2",500,707],["b2+",520,720],["b3",353,500],["b4",250,353],["b5",176,250],["b6",125,176],["b7",88,125],["b8",62,88],["b9",44,62],["b10",31,44],["b11",22,32],["b12",16,22],["c0",917,1297],["c1",648,917],["c2",458,648],["c3",324,458],["c4",229,324],["c5",162,229],["c6",114,162],["c7",81,114],["c8",57,81],["c9",40,57],["c10",28,40],["c11",22,32],["c12",16,22],["half-letter",5.5,8.5,"in"],["letter",8.5,11,"in"],["legal",8.5,14,"in"],["junior-legal",5,8,"in"],["ledger",11,17,"in"],["tabloid",11,17,"in"],["ansi-a",8.5,11,"in"],["ansi-b",11,17,"in"],["ansi-c",17,22,"in"],["ansi-d",22,34,"in"],["ansi-e",34,44,"in"],["arch-a",9,12,"in"],["arch-b",12,18,"in"],["arch-c",18,24,"in"],["arch-d",24,36,"in"],["arch-e",36,48,"in"],["arch-e1",30,42,"in"],["arch-e2",26,38,"in"],["arch-e3",27,39,"in"]].reduce((function(e,t){var n={units:t[3]||"mm",dimensions:[t[1],t[2]]};return e[t[0]]=n,e[t[0].replace(/-/g," ")]=n,e}),{}),F=["mm","cm","m","pc","pt","in","ft","px"],L={m:{system:"metric",factor:1},cm:{system:"metric",factor:.01},mm:{system:"metric",factor:.001},pt:{system:"imperial",factor:1/72},pc:{system:"imperial",factor:1/6},in:{system:"imperial",factor:1},ft:{system:"imperial",factor:12}};const D={metric:{unit:"m",ratio:1/.0254},imperial:{unit:"in",ratio:.0254}};var H=function(e,t,n,r){if("number"!=typeof e||!isFinite(e))throw new Error("Value must be a finite number");if(!t||!n)throw new Error("Must specify from and to units");var o=function(){for(var e=0;e<arguments.length;e++)if(void 0!==arguments[e])return arguments[e]}((r=r||{}).pixelsPerInch,96),i=r.precision,a=!1!==r.roundPixel;if(t=t.toLowerCase(),n=n.toLowerCase(),-1===F.indexOf(t))throw new Error('Invalid from unit "'+t+'", must be one of: '+F.join(", "));if(-1===F.indexOf(n))throw new Error('Invalid from unit "'+n+'", must be one of: '+F.join(", "));if(t===n)return e;var s=1,u=1,c=!1;"px"===t&&(u=1/o,t="in"),"px"===n&&(c=!0,s=o,n="in");var f=L[t],l=L[n],p=e*f.factor*u;f.system!==l.system&&(p*=D[f.system].ratio);var d=p/l.factor*s;return c&&a?d=Math.round(d):"number"==typeof i&&isFinite(i)&&(d=function(e,t){return Number(Math.round(e+"e"+t)+"e-"+t)}(d,i)),d};function N(e,t,n,r){return void 0===t&&(t="px"),void 0===n&&(n="px"),void 0===r&&(r=72),H(e,t,n,{pixelsPerInch:r,precision:4,roundPixel:!0})}function I(e,t){var n,r,o,i,a,s,u=p(),c=t.dimensions,f=function(e){return!(!e.dimensions||"string"!=typeof e.dimensions&&!(Array.isArray(e.dimensions)&&e.dimensions.length>=2))}(t),d=e.exporting,h=!!f&&!1!==t.scaleToFit,m=!(!d&&f)||t.scaleToView;u||(h=m=!1);var g,y,v=t.units,b="number"==typeof t.pixelsPerInch&&isFinite(t.pixelsPerInch)?t.pixelsPerInch:72,w=l(t.bleed,0),x=u?window.devicePixelRatio:1,M=m?x:1;"number"==typeof t.pixelRatio&&isFinite(t.pixelRatio)?y=l(t.exportPixelRatio,g=t.pixelRatio):f?(g=M,y=l(t.exportPixelRatio,1)):y=l(t.exportPixelRatio,g=x),"number"==typeof t.maxPixelRatio&&isFinite(t.maxPixelRatio)&&(g=Math.min(t.maxPixelRatio,g)),d&&(g=y);var k,_,T=function(e,t){if(!p())return[300,150];var n=t.parent||window;if(n===window||n===document||n===document.body)return[window.innerWidth,window.innerHeight];var r=n.getBoundingClientRect();return[r.width,r.height]}(0,t),E=T[0],j=T[1];if(f){var R=function(e,t,n){if(void 0===t&&(t="px"),void 0===n&&(n=72),"string"==typeof e){var r=e.toLowerCase();if(!(r in A))throw new Error('The dimension preset "'+e+'" is not supported or could not be found; try using a4, a3, postcard, letter, etc.');var o=A[r];return o.dimensions.map((function(e){return N(e,o.units,t,n)}))}return e}(c,v,b),P=Math.max(R[0],R[1]),O=Math.min(R[0],R[1]);if(t.orientation){var S="landscape"===t.orientation;n=S?P:O,r=S?O:P}else n=R[0],r=R[1];k=n,_=r,n+=2*w,r+=2*w}else k=n=E,_=r=j;var C=n,F=r;if(f&&v&&(C=N(n,v,"px",b),F=N(r,v,"px",b)),o=Math.round(C),i=Math.round(F),h&&!d&&f){var L=n/r,D=E/j,H=l(t.scaleToFitPadding,40),I=Math.round(E-2*H),q=Math.round(j-2*H);(o>I||i>q)&&(D>L?(i=q,o=Math.round(i*L)):(o=I,i=Math.round(o/L)))}return{bleed:w,pixelRatio:g,width:n,height:r,dimensions:[n,r],units:v||"px",scaleX:(a=m?Math.round(g*o):Math.round(g*C))/n,scaleY:(s=m?Math.round(g*i):Math.round(g*F))/r,pixelsPerInch:b,viewportWidth:m?Math.round(o):Math.round(C),viewportHeight:m?Math.round(i):Math.round(F),canvasWidth:a,canvasHeight:s,trimWidth:k,trimHeight:_,styleWidth:o,styleHeight:i}}H.units=F;var q=function(e,t){if("string"!=typeof e)throw new TypeError("must specify type string");if(t=t||{},"undefined"==typeof document&&!t.canvas)return null;var n=t.canvas||document.createElement("canvas");"number"==typeof t.width&&(n.width=t.width);"number"==typeof t.height&&(n.height=t.height);var r,o=t;try{var i=[e];0===e.indexOf("webgl")&&i.push("experimental-"+e);for(var a=0;a<i.length;a++)if(r=n.getContext(i[a],o))return r}catch(e){r=null}return r||null};function U(e){var t,n;void 0===e&&(e={});var r=!1;if(!1!==e.canvas){if(!(t=e.context)||"string"==typeof t){var i=e.canvas;i||(i=function(){if(!p())throw new Error("It appears you are runing from Node.js or a non-browser environment. Try passing in an existing { canvas } interface instead.");return document.createElement("canvas")}(),r=!0);var a=t||"2d";if("function"!=typeof i.getContext)throw new Error("The specified { canvas } element does not have a getContext() function, maybe it is not a <canvas> tag?");if(!(t=q(a,o({},e.attributes,{canvas:i}))))throw new Error("Failed at canvas.getContext('"+a+"') - the browser may not support this context, or a different context may already be in use with this canvas.")}if(n=t.canvas,e.canvas&&n!==e.canvas)throw new Error("The { canvas } and { context } settings must point to the same underlying canvas element");e.pixelated&&(t.imageSmoothingEnabled=!1,t.mozImageSmoothingEnabled=!1,t.oImageSmoothingEnabled=!1,t.webkitImageSmoothingEnabled=!1,t.msImageSmoothingEnabled=!1,n.style["image-rendering"]="pixelated")}return{canvas:n,context:t,ownsCanvas:r}}var z=function(){var e=this;this._settings={},this._props={},this._sketch=void 0,this._raf=null,this._recordTimeout=null,this._lastRedrawResult=void 0,this._isP5Resizing=!1,this._keyboardShortcuts=function(e){void 0===e&&(e={});var t=function(t){if(e.enabled()){var n=f();83!==t.keyCode||t.altKey||!t.metaKey&&!t.ctrlKey?32===t.keyCode?e.togglePlay(t):n&&!t.altKey&&75===t.keyCode&&(t.metaKey||t.ctrlKey)&&(t.preventDefault(),e.commit(t)):(t.preventDefault(),e.save(t))}};return{attach:function(){window.addEventListener("keydown",t)},detach:function(){window.removeEventListener("keydown",t)}}}({enabled:function(){return!1!==e.settings.hotkeys},save:function(t){t.shiftKey?e.props.recording?(e.endRecord(),e.run()):e.record():e.props.recording||e.exportFrame()},togglePlay:function(){e.props.playing?e.pause():e.play()},commit:function(t){e.exportFrame({commit:!0})}}),this._animateHandler=function(){return e.animate()},this._resizeHandler=function(){e.resize()&&e.render()}},B={sketch:{configurable:!0},settings:{configurable:!0},props:{configurable:!0}};B.sketch.get=function(){return this._sketch},B.settings.get=function(){return this._settings},B.props.get=function(){return this._props},z.prototype._computePlayhead=function(e,t){return"number"==typeof t&&isFinite(t)?e/t:0},z.prototype._computeFrame=function(e,t,n,r){return isFinite(n)&&n>1?Math.floor(e*(n-1)):Math.floor(r*t)},z.prototype._computeCurrentFrame=function(){return this._computeFrame(this.props.playhead,this.props.time,this.props.totalFrames,this.props.fps)},z.prototype._getSizeProps=function(){var e=this.props;return{width:e.width,height:e.height,pixelRatio:e.pixelRatio,canvasWidth:e.canvasWidth,canvasHeight:e.canvasHeight,viewportWidth:e.viewportWidth,viewportHeight:e.viewportHeight}},z.prototype.run=function(){if(!this.sketch)throw new Error("should wait until sketch is loaded before trying to play()");return!1!==this.settings.playing&&this.play(),"function"==typeof this.sketch.dispose&&console.warn("In canvas-sketch@0.0.23 the dispose() event has been renamed to unload()"),this.props.started||(this._signalBegin(),this.props.started=!0),this.tick(),this.render(),this},z.prototype._cancelTimeouts=function(){null!=this._raf&&"undefined"!=typeof window&&"function"==typeof window.cancelAnimationFrame&&(window.cancelAnimationFrame(this._raf),this._raf=null),null!=this._recordTimeout&&(clearTimeout(this._recordTimeout),this._recordTimeout=null)},z.prototype.play=function(){var e=this.settings.animate;"animation"in this.settings&&(e=!0,console.warn("[canvas-sketch] { animation } has been renamed to { animate }")),e&&(p()?this.props.playing||(this.props.started||(this._signalBegin(),this.props.started=!0),this.props.playing=!0,this._cancelTimeouts(),this._lastTime=s(),this._raf=window.requestAnimationFrame(this._animateHandler)):console.error("[canvas-sketch] WARN: Using { animate } in Node.js is not yet supported"))},z.prototype.pause=function(){this.props.recording&&this.endRecord(),this.props.playing=!1,this._cancelTimeouts()},z.prototype.togglePlay=function(){this.props.playing?this.pause():this.play()},z.prototype.stop=function(){this.pause(),this.props.frame=0,this.props.playhead=0,this.props.time=0,this.props.deltaTime=0,this.props.started=!1,this.render()},z.prototype.record=function(){var e=this;if(!this.props.recording)if(p()){this.stop(),this.props.playing=!0,this.props.recording=!0;var t=this._createExportOptions({sequence:!0}),n=1/this.props.fps;this._cancelTimeouts();var r,o=function(){return e.props.recording?(e.props.deltaTime=n,e.tick(),e.exportFrame(t).then((function(){e.props.recording&&(e.props.deltaTime=0,e.props.frame++,e.props.frame<e.props.totalFrames?(e.props.time+=n,e.props.playhead=e._computePlayhead(e.props.time,e.props.duration),e._recordTimeout=setTimeout(o,0)):(console.log("Finished recording"),e._signalEnd(),e.endRecord(),e.stop(),e.run()))}))):Promise.resolve()};this.props.started||(this._signalBegin(),this.props.started=!0),this.sketch&&"function"==typeof this.sketch.beginRecord&&this._wrapContextScale((function(t){return e.sketch.beginRecord(t)})),(r=t,void 0===r&&(r={}),E(!0,r)).catch((function(e){console.error(e)})).then((function(t){e._raf=window.requestAnimationFrame(o)}))}else console.error("[canvas-sketch] WARN: Recording from Node.js is not yet supported")},z.prototype._signalBegin=function(){var e=this;this.sketch&&"function"==typeof this.sketch.begin&&this._wrapContextScale((function(t){return e.sketch.begin(t)}))},z.prototype._signalEnd=function(){var e=this;this.sketch&&"function"==typeof this.sketch.end&&this._wrapContextScale((function(t){return e.sketch.end(t)}))},z.prototype.endRecord=function(){var e,t=this,n=this.props.recording;return this._cancelTimeouts(),this.props.recording=!1,this.props.deltaTime=0,this.props.playing=!1,(void 0===e&&(e={}),E(!1,e)).catch((function(e){console.error(e)})).then((function(){n&&t.sketch&&"function"==typeof t.sketch.endRecord&&t._wrapContextScale((function(e){return t.sketch.endRecord(e)}))}))},z.prototype._createExportOptions=function(e){return void 0===e&&(e={}),{sequence:e.sequence,save:e.save,fps:this.props.fps,frame:e.sequence?this.props.frame:void 0,file:this.settings.file,name:this.settings.name,prefix:this.settings.prefix,suffix:this.settings.suffix,encoding:this.settings.encoding,encodingQuality:this.settings.encodingQuality,timeStamp:e.timeStamp||v(new Date,"yyyy.mm.dd-HH.MM.ss"),totalFrames:isFinite(this.props.totalFrames)?Math.max(0,this.props.totalFrames):1e3}},z.prototype.exportFrame=function(e){var t=this;if(void 0===e&&(e={}),!this.sketch)return Promise.all([]);"function"==typeof this.sketch.preExport&&this.sketch.preExport();var n=this._createExportOptions(e),r=f(),i=Promise.resolve();if(r&&e.commit&&"function"==typeof r.commit){var a=o({},n),s=r.commit(a);i=u(s)?s:Promise.resolve(s)}return i.then((function(e){return t._doExportFrame(o({},n,{hash:e||""}))})).then((function(e){return 1===e.length?e[0]:e}))},z.prototype._doExportFrame=function(e){var t=this;void 0===e&&(e={}),this._props.exporting=!0,this.resize();var n=this.render();return void 0===n&&(n=[this.props.canvas]),n=(n=[].concat(n).filter(Boolean)).map((function(t){var n,r="object"==typeof t&&t&&("data"in t||"dataURL"in t),i=r?t.data:t,a=r?o({},t,{data:i}):{data:i};if(c(n=i)&&/canvas/i.test(n.nodeName)&&"function"==typeof n.getContext){var s=function(e,t){void 0===t&&(t={});var n=t.encoding||"image/png";if(!T.includes(n))throw new Error("Invalid canvas encoding "+n);var r=(n.split("/")[1]||"").replace(/jpeg/i,"jpg");return r&&(r=("."+r).toLowerCase()),{extension:r,type:n,dataURL:e.toDataURL(n,t.encodingQuality)}}(i,{encoding:a.encoding||e.encoding,encodingQuality:l(a.encodingQuality,e.encodingQuality,.95)});return Object.assign(a,{dataURL:s.dataURL,extension:s.extension,type:s.type})}return a})),this._props.exporting=!1,this.resize(),this.render(),Promise.all(n.map((function(t,n,r){var i=o({extension:"",prefix:"",suffix:""},e,t,{layer:n,totalLayers:r.length}),a=!1!==e.save&&t.save;for(var s in i.save=!1!==a,i.filename=P(i),delete i.encoding,delete i.encodingQuality,i)void 0===i[s]&&delete i[s];var u=Promise.resolve({});if(i.save){var c=i.data;if(i.dataURL)u=j(i.dataURL,i);else u=function(e,t){void 0===t&&(t={});var n=Array.isArray(e)?e:[e];return R(new window.Blob(n,{type:t.type||""}),t)}(c,i)}return u.then((function(e){return Object.assign({},i,e)}))}))).then((function(n){var r=n.filter((function(e){return e.save}));if(r.length>0){var o,i=r.find((function(e){return e.outputName})),a=r.some((function(e){return e.client})),s=r.some((function(e){return e.stream}));o=r.length>1?r.length:i?i.outputName+"/"+r[0].filename:""+r[0].filename;var u="";if(e.sequence)u=isFinite(t.props.totalFrames)?" (frame "+(e.frame+1)+" / "+t.props.totalFrames+")":" (frame "+e.frame+")";else r.length>1&&(u=" files");console.log("%c["+(a?"canvas-sketch-cli":"canvas-sketch")+"]%c "+(s?"Streaming into":"Exported")+" %c"+o+"%c"+u,"color: #8e8e8e;","color: initial;","font-weight: bold;","font-weight: initial;")}return"function"==typeof t.sketch.postExport&&t.sketch.postExport(),n}))},z.prototype._wrapContextScale=function(e){this._preRender(),e(this.props),this._postRender()},z.prototype._preRender=function(){var e=this.props;d(e.context)&&!e.p5?(e.context.save(),!1!==this.settings.scaleContext&&e.context.scale(e.scaleX,e.scaleY)):e.p5&&e.p5.scale(e.scaleX/e.pixelRatio,e.scaleY/e.pixelRatio)},z.prototype._postRender=function(){var e=this.props;d(e.context)&&!e.p5&&e.context.restore(),e.gl&&!1!==this.settings.flush&&!e.p5&&e.gl.flush()},z.prototype.tick=function(){this.sketch&&"function"==typeof this.sketch.tick&&(this._preRender(),this.sketch.tick(this.props),this._postRender())},z.prototype.render=function(){return this.props.p5?(this._lastRedrawResult=void 0,this.props.p5.redraw(),this._lastRedrawResult):this.submitDrawCall()},z.prototype.submitDrawCall=function(){if(this.sketch){var e,t=this.props;return this._preRender(),"function"==typeof this.sketch?e=this.sketch(t):"function"==typeof this.sketch.render&&(e=this.sketch.render(t)),this._postRender(),e}},z.prototype.update=function(e){var t=this;void 0===e&&(e={});var n=["animate"];Object.keys(e).forEach((function(e){if(n.indexOf(e)>=0)throw new Error("Sorry, the { "+e+" } option is not yet supported with update().")}));var r=this._settings.canvas,o=this._settings.context;for(var i in e){var a=e[i];void 0!==a&&(t._settings[i]=a)}var s=Object.assign({},this._settings,e);if("time"in e&&"frame"in e)throw new Error("You should specify { time } or { frame } but not both");if("time"in e?delete s.frame:"frame"in e&&delete s.time,"duration"in e&&"totalFrames"in e)throw new Error("You should specify { duration } or { totalFrames } but not both");"duration"in e?delete s.totalFrames:"totalFrames"in e&&delete s.duration,"data"in e&&(this._props.data=e.data);var u=this.getTimeProps(s);if(Object.assign(this._props,u),r!==this._settings.canvas||o!==this._settings.context){var c=U(this._settings),f=c.context;this.props.canvas=c.canvas,this.props.context=f,this._setupGLKey(),this._appendCanvasIfNeeded()}return e.p5&&"function"!=typeof e.p5&&(this.props.p5=e.p5,this.props.p5.draw=function(){t._isP5Resizing||(t._lastRedrawResult=t.submitDrawCall())}),"playing"in e&&(e.playing?this.play():this.pause()),C(this._settings),this.resize(),this.render(),this.props},z.prototype.resize=function(){var e=this._getSizeProps(),t=this.settings,n=this.props,r=I(n,t);Object.assign(this._props,r);var o=this.props,i=o.pixelRatio,a=o.canvasWidth,s=o.canvasHeight,u=o.styleWidth,c=o.styleHeight,f=this.props.canvas;f&&!1!==t.resizeCanvas&&(n.p5?f.width===a&&f.height===s||(this._isP5Resizing=!0,n.p5.pixelDensity(i),n.p5.resizeCanvas(a/i,s/i,!1),this._isP5Resizing=!1):(f.width!==a&&(f.width=a),f.height!==s&&(f.height=s)),p()&&!1!==t.styleCanvas&&(f.style.width=u+"px",f.style.height=c+"px"));var l=this._getSizeProps(),d=!y(e,l);return d&&this._sizeChanged(),d},z.prototype._sizeChanged=function(){this.sketch&&"function"==typeof this.sketch.resize&&this.sketch.resize(this.props)},z.prototype.animate=function(){if(this.props.playing)if(p()){this._raf=window.requestAnimationFrame(this._animateHandler);var e=s(),t=1e3/this.props.fps,n=e-this._lastTime,r=this.props.duration,o="number"==typeof r&&isFinite(r),i=!0,a=this.settings.playbackRate;"fixed"===a?n=t:"throttle"===a?n>t?this._lastTime=e-=n%t:i=!1:this._lastTime=e;var u=n/1e3,c=this.props.time+u*this.props.timeScale;c<0&&o&&(c=r+c);var f=!1,l=!1;if(o&&c>=r&&(!1!==this.settings.loop?(i=!0,c%=r,l=!0):(i=!1,c=r,f=!0),this._signalEnd()),i){this.props.deltaTime=u,this.props.time=c,this.props.playhead=this._computePlayhead(c,r);var d=this.props.frame;this.props.frame=this._computeCurrentFrame(),l&&this._signalBegin(),d!==this.props.frame&&this.tick(),this.render(),this.props.deltaTime=0}f&&this.pause()}else console.error("[canvas-sketch] WARN: Animation in Node.js is not yet supported")},z.prototype.dispatch=function(e){if("function"!=typeof e)throw new Error("must pass function into dispatch()");e(this.props),this.render()},z.prototype.mount=function(){this._appendCanvasIfNeeded()},z.prototype.unmount=function(){p()&&(window.removeEventListener("resize",this._resizeHandler),this._keyboardShortcuts.detach()),this.props.canvas.parentElement&&this.props.canvas.parentElement.removeChild(this.props.canvas)},z.prototype._appendCanvasIfNeeded=function(){p()&&(!1!==this.settings.parent&&this.props.canvas&&!this.props.canvas.parentElement&&(this.settings.parent||document.body).appendChild(this.props.canvas))},z.prototype._setupGLKey=function(){var e;this.props.context&&((e=this.props.context)&&"function"==typeof e.clear&&"function"==typeof e.clearColor&&"function"==typeof e.bufferData?this._props.gl=this.props.context:delete this._props.gl)},z.prototype.getTimeProps=function(e){void 0===e&&(e={});var t=e.duration,n=e.totalFrames,r=l(e.timeScale,1),o=l(e.fps,24),i="number"==typeof t&&isFinite(t),a="number"==typeof n&&isFinite(n),s=i?Math.floor(o*t):void 0,u=a?n/o:void 0;if(i&&a&&s!==n)throw new Error("You should specify either duration or totalFrames, but not both. Or, they must match exactly.");void 0===e.dimensions&&void 0!==e.units&&console.warn("You've specified a { units } setting but no { dimension }, so the units will be ignored."),n=l(n,s,Infinity),t=l(t,u,Infinity);var c=e.time,f=e.frame,p="number"==typeof c&&isFinite(c),d="number"==typeof f&&isFinite(f),h=0,m=0,g=0;if(p&&d)throw new Error("You should specify either start frame or time, but not both.");return p?(g=this._computePlayhead(h=c,t),m=this._computeFrame(g,h,n,o)):d&&(g=this._computePlayhead(h=(m=f)/o,t)),{playhead:g,time:h,frame:m,duration:t,totalFrames:n,fps:o,timeScale:r}},z.prototype.setup=function(e){var t=this;if(void 0===e&&(e={}),this.sketch)throw new Error("Multiple setup() calls not yet supported.");this._settings=Object.assign({},e,this._settings),C(this._settings);var n=U(this._settings),r=n.context,o=n.canvas,i=this.getTimeProps(this._settings);this._props=Object.assign({},i,{canvas:o,context:r,deltaTime:0,started:!1,exporting:!1,playing:!1,recording:!1,settings:this.settings,data:this.settings.data,render:function(){return t.render()},togglePlay:function(){return t.togglePlay()},dispatch:function(e){return t.dispatch(e)},tick:function(){return t.tick()},resize:function(){return t.resize()},update:function(e){return t.update(e)},exportFrame:function(e){return t.exportFrame(e)},record:function(){return t.record()},play:function(){return t.play()},pause:function(){return t.pause()},stop:function(){return t.stop()}}),this._setupGLKey(),this.resize()},z.prototype.loadAndRun=function(e,t){var n=this;return this.load(e,t).then((function(){return n.run(),n}))},z.prototype.unload=function(){var e=this;this.pause(),this.sketch&&("function"==typeof this.sketch.unload&&this._wrapContextScale((function(t){return e.sketch.unload(t)})),this._sketch=null)},z.prototype.destroy=function(){this.unload(),this.unmount()},z.prototype.load=function(e,t){var n=this;if("function"!=typeof e)throw new Error("The function must take in a function as the first parameter. Example:\n  canvasSketcher(() => { ... }, settings)");this.sketch&&this.unload(),void 0!==t&&this.update(t),this._preRender();var r=Promise.resolve();if(this.settings.p5){if(!p())throw new Error("[canvas-sketch] ERROR: Using p5.js in Node.js is not supported");r=new Promise((function(e){var t,r=n.settings.p5;r.p5&&(t=r.preload,r=r.p5);var o=function(r){t&&(r.preload=function(){return t(r)}),r.setup=function(){var t=n.props,o="webgl"===n.settings.context,i=o?r.WEBGL:r.P2D;r.noLoop(),r.pixelDensity(t.pixelRatio),r.createCanvas(t.viewportWidth,t.viewportHeight,i),o&&n.settings.attributes&&r.setAttributes(n.settings.attributes),n.update({p5:r,canvas:r.canvas,context:r._renderer.drawingContext}),e()}};if("function"==typeof r)new r(o);else{if("function"!=typeof window.createCanvas)throw new Error("{ p5 } setting is passed but can't find p5.js in global (window) scope. Maybe you did not create it globally?\nnew p5(); // <-- attaches to global scope");o(window)}}))}return r.then((function(){var t=e(n.props);return u(t)||(t=Promise.resolve(t)),t})).then((function(e){return e||(e={}),n._sketch=e,p()&&(n._keyboardShortcuts.attach(),window.addEventListener("resize",n._resizeHandler)),n._postRender(),n._sizeChanged(),n})).catch((function(e){throw console.warn("Could not start sketch, the async loading function rejected with an error:\n    Error: "+e.message),e}))},Object.defineProperties(z.prototype,B);var W="hot-id-cache",G=[];function X(e,t){if(void 0===t&&(t={}),t.p5){if(t.canvas||t.context&&"string"!=typeof t.context)throw new Error('In { p5 } mode, you can\'t pass your own canvas or context, unless the context is a "webgl" or "2d" string');t=Object.assign({},t,{canvas:!1,context:"string"==typeof t.context&&t.context})}var n,r,o=(n=f())&&n.hot;o&&(r=l(t.id,"$__DEFAULT_CANVAS_SKETCH_ID__$"));var i=o&&"string"==typeof r;i&&G.includes(r)&&(console.warn("Warning: You have multiple calls to canvasSketch() in --hot mode. You must pass unique { id } strings in settings to enable hot reload across multiple sketches. ",r),i=!1);var a=Promise.resolve();if(i){G.push(r);var s=function(e){var t=f();if(t)return t[W]=t[W]||{},t[W][e]}(r);if(s){var u=function(){var e,n=(e=s.manager,t.animate?{time:e.props.time}:void 0);return s.manager.destroy(),n};a=s.load.then(u).catch(u)}}return a.then((function(n){var o,a=new z;return e?(t=Object.assign({},t,n),a.setup(t),a.mount(),o=a.loadAndRun(e)):o=Promise.resolve(a),i&&function(e,t){var n=f();n&&(n[W]=n[W]||{},n[W][e]=t)}(r,{load:o,manager:a}),o}))}return X.canvasSketch=X,X.PaperSizes=A,X}))}).call(this)}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],14:[function(e,t,n){t.exports=function(e,t,n){return t<n?e<t?t:e>n?n:e:e<n?n:e>t?t:e}},{}],15:[function(e,t,n){"use strict";t.exports=function(){for(var e=0;e<arguments.length;e++)if(void 0!==arguments[e])return arguments[e]}},{}],16:[function(e,t,n){t.exports=function(e){var t,n,r,o,i,a=e[0],s=e[1],u=e[2];if(0===s)return[i=u,i,i];n=u<.5?u*(1+s):u+s-u*s;t=2*u-n,o=[0,0,0];for(var c=0;c<3;c++)(r=a+1/3*-(c-1))<0&&r++,r>1&&r--,o[c]=i=6*r<1?t+6*(n-t)*r:2*r<1?n:3*r<2?t+(n-t)*(2/3-r)*6:t;return o}},{}],17:[function(e,t,n){t.exports=function(e){var t,n,r,o=e[0],i=e[1],a=e[2],s=Math.min(o,i,a),u=Math.max(o,i,a),c=u-s;u===s?t=0:o===u?t=(i-a)/c:i===u?t=2+(a-o)/c:a===u&&(t=4+(o-i)/c);(t=Math.min(60*t,360))<0&&(t+=360);r=(s+u)/2,n=u===s?0:r<=.5?c/(u+s):c/(2-u-s);return[t/360,n,r]}},{}],18:[function(e,t,n){(function(e){(function(){var n;n="undefined"!=typeof window?window:void 0!==e?e:"undefined"!=typeof self?self:{},t.exports=n}).call(this)}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],19:[function(e,t,n){t.exports=function(e){if(!e)return!1;var t=r.call(e);return"[object Function]"===t||"function"==typeof e&&"[object RegExp]"!==t||"undefined"!=typeof window&&(e===window.setTimeout||e===window.alert||e===window.confirm||e===window.prompt)};var r=Object.prototype.toString},{}],20:[function(e,t,n){function r(e){return!!e&&("object"==typeof e||"function"==typeof e)&&"function"==typeof e.then}t.exports=r,t.exports.default=r},{}],21:[function(e,t,n){var r=e("./loaders"),o=e("object-assign"),i=e("is-promise"),a=function(){};function s(e,t,n){if("function"!=typeof(t=t||a))return Promise.reject(new Error("The second argument to load.all() and load.any() must be a function, or undefined"));var r,o,i=0,s=function(e,n,o,i){var a={target:e,total:r,count:o,progress:o/r,value:n};i&&(a.error=i),t(a)};if(o=n?function(e){return u(e).then((function(e){return{value:e}}),(function(e){return{value:null,error:e}})).then((function(t){return s(e,t.value,++i,t.error),t.value}))}:function(e){return u(e).then((function(t){return s(e,t,++i),t}))},Array.isArray(e))return r=e.length,Promise.all(e.map((function(e){return o(e)})));if(e){var c=Object.keys(e).map((function(t){return{key:t,value:e[t]}}));return r=c.length,Promise.all(c.map((function(e){var t=e.key;return o(e.value).then((function(e){return{value:e,key:t}}))}))).then((function(e){return e.reduce((function(e,t){return e[t.key]=t.value,e}),{})}))}return Promise.reject(new Error("You must specify an array of assets or object group to load"))}function u(e){return e?("string"==typeof e&&(e={url:e}),i(e)?e:function(e){var t,n,o=e.type?e.type:null;if(o){if("function"==typeof o)return Promise.resolve(o);if(o=o.toLowerCase(),!e.url)return Promise.reject(new Error("When using loadAsset(), you must specify a URL or descriptor of the asset to load"));for(t=0;t<r.length;t++)if((n=r[t]).key===o)return Promise.resolve(n.load);return Promise.reject(new Error('Could not find an asset loader by the key "'+e.type+'"'))}if(!e.url)return Promise.reject(new Error("When using loadAsset(), you must specify a URL or descriptor of the asset to load"));var i=function(e){if(!e)return"";var t=e.lastIndexOf("/");-1!==t&&(e=e.substring(t+1));-1!==(t=e.indexOf("?"))&&(e=e.substring(0,t));-1!==(t=e.indexOf("#"))&&(e=e.substring(0,t));return-1!==(t=e.lastIndexOf("."))?e.substring(t):""}(e.url);if(!i)return Promise.reject(new Error('No extension found for input URL "'+e.url+'", try to specify a { type } such as "image" or "text"'));for(t=0;t<r.length;t++){if((n=r[t]).match)if("function"==typeof n.match?n.match(i):n.match.test(i))return Promise.resolve(n.load)}return Promise.reject(new Error('Could not infer an asset loader from the file type "'+i+'", try specifying { type } such as "image" or "text"'))}(e).then((function(t){return delete(e=o({},e)).type,t(e)}))):Promise.reject(new Error("You must specify a URL or descriptor of the asset to load"))}t.exports=u,t.exports.all=function(e,t){return s(e,t,!1)},t.exports.any=function(e,t){return s(e,t,!0)}},{"./loaders":24,"is-promise":20,"object-assign":26}],22:[function(e,t,n){var r=e("xhr"),o=e("object-assign");t.exports=function(e){return function(t){var n;return n="fetch"in window?window.fetch(t.url,t).then((function(t){if(/404/.test(t.status))throw new Error("Resource not found");if(!/^2/.test(t.status))throw new Error("Unexpected HTTP Status Code: "+t.status);if(!t.ok)throw new Error("Response not OK");return"json"===e?t.json():"binary"===e?t.arrayBuffer():"blob"===e?t.blob():t.text()})):function(e,t){return new Promise((function(n,i){var a="text";"json"===e?a="text":"binary"===e?a="arraybuffer":"blob"===e&&(a="blob"),t=o({},t,{json:!1,responseType:a}),r(t,(function(t,r,o){if(t)return i(t);if(/404/.test(r.statusCode))throw new Error("Resource not found");if(!/^2/.test(r.statusCode))return i(new Error("Unexpected HTTP Status Code: "+r.statusCode));if("json"===e)try{o=JSON.parse(o)}catch(t){return i(t)}n(o)}))}))}(e,t),n.catch((function(e){throw new Error(e.message+" while loading file "+t.url)}))}}},{"object-assign":26,xhr:29}],23:[function(e,t,n){var r=e("browser-media-mime-type");t.exports=function(e,t){return{key:e,match:function(t){return function(e){var t=r(e);return t?0===t.indexOf("audio")?"audio":0===t.indexOf("video")?"video":null:null}(t)===e},load:function(n){return new Promise((function(r,o){var i=!1,a=t(),s=function(){i||(i=!0,r(a))},u=(n.event||"canplay").toLowerCase();if("loadedmetadata"===u?a.onloadedmetadata=s:"canplaythrough"===u?a.oncanplaythrough=s:"loadeddata"===u?a.onloadeddata=s:a.oncanplay=s,a.onerror=function(t){i||(i=!0,o(new Error("Error while loading "+e+" at "+n.url)))},n.crossOrigin&&(a.crossOrigin=n.crossOrigin),void 0!==n.volume&&(a.volume=n.volume),void 0!==n.preload&&(a.preload=n.volume),void 0!==n.playbackRate&&(a.playbackRate=n.volume),void 0!==n.muted&&(a.muted=n.volume),void 0!==n.currentTime&&(a.currentTime=n.volume),void 0!==n.controls&&(a.controls=n.volume),void 0!==n.autoPlay&&(a.autoPlay=n.volume),a.src=n.url,a.readyState>=a.HAVE_ENOUGH_DATA)return i=!0,r(a);a.load()}))}}}},{"browser-media-mime-type":2}],24:[function(e,t,n){const r=e("./createMediaLoader"),o=e("./createFileLoader"),i=e("./loadImage");t.exports=[{key:"json",match:/\.json$/i,load:o("json")},{key:"text",match:/\.txt$/i,load:o("text")},{key:"image",match:/\.(jpg|jpeg|svg|png|gif|webp|bmp|tga|tif|apng|wbpm|ico)$/i,load:i},r("audio",(function(){return new window.Audio})),r("video",(function(){return document.createElement("video")})),{key:"binary",match:/\.bin$/i,load:o("binary")},{key:"blob",load:o("blob")}]},{"./createFileLoader":22,"./createMediaLoader":23,"./loadImage":25}],25:[function(e,t,n){t.exports=function(e){return new Promise((function(t,n){var r=!1,o=new window.Image;o.onload=function(){r||(r=!0,t(o))},o.onerror=function(){r||(r=!0,n(new Error("Error while loading image at "+e.url)))},e.crossOrigin&&(o.crossOrigin=e.crossOrigin),o.src=e.url}))}},{}],26:[function(e,t,n){"use strict";var r=Object.getOwnPropertySymbols,o=Object.prototype.hasOwnProperty,i=Object.prototype.propertyIsEnumerable;t.exports=function(){try{if(!Object.assign)return!1;var e=new String("abc");if(e[5]="de","5"===Object.getOwnPropertyNames(e)[0])return!1;for(var t={},n=0;n<10;n++)t["_"+String.fromCharCode(n)]=n;if("0123456789"!==Object.getOwnPropertyNames(t).map((function(e){return t[e]})).join(""))return!1;var r={};return"abcdefghijklmnopqrst".split("").forEach((function(e){r[e]=e})),"abcdefghijklmnopqrst"===Object.keys(Object.assign({},r)).join("")}catch(e){return!1}}()?Object.assign:function(e,t){for(var n,a,s=function(e){if(null==e)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(e)}(e),u=1;u<arguments.length;u++){for(var c in n=Object(arguments[u]))o.call(n,c)&&(s[c]=n[c]);if(r){a=r(n);for(var f=0;f<a.length;f++)i.call(n,a[f])&&(s[a[f]]=n[a[f]])}}return s}},{}],27:[function(e,t,n){var r=function(e){return e.replace(/^\s+|\s+$/g,"")};t.exports=function(e){if(!e)return{};for(var t={},n=r(e).split("\n"),o=0;o<n.length;o++){var i=n[o],a=i.indexOf(":"),s=r(i.slice(0,a)).toLowerCase(),u=r(i.slice(a+1));void 0===t[s]?t[s]=u:"[object Array]"===Object.prototype.toString.call(t[s])?t[s].push(u):t[s]=[t[s],u]}return t}},{}],28:[function(e,t,n){(function(e){(function(){"use strict";var n={1:"lpcm",3:"lpcm"};function r(t,n){n=n||{},e.Buffer&&t instanceof e.Buffer&&(t=Uint8Array.from(t).buffer);var r=function(e){var t=0;return{remain:function(){return e.byteLength-t},skip:function(e){t+=e},uint8:function(){var n=e.getUint8(t,!0);return t+=1,n},int16:function(){var n=e.getInt16(t,!0);return t+=2,n},uint16:function(){var n=e.getUint16(t,!0);return t+=2,n},uint32:function(){var n=e.getUint32(t,!0);return t+=4,n},string:function(e){for(var t="",n=0;n<e;n++)t+=String.fromCharCode(this.uint8());return t},pcm8:function(){var n=e.getUint8(t)-128;return t+=1,n<0?n/128:n/127},pcm8s:function(){var n=e.getUint8(t)-127.5;return t+=1,n/127.5},pcm16:function(){var n=e.getInt16(t,!0);return t+=2,n<0?n/32768:n/32767},pcm16s:function(){var n=e.getInt16(t,!0);return t+=2,n/32768},pcm24:function(){var n=e.getUint8(t+0)+(e.getUint8(t+1)<<8)+(e.getUint8(t+2)<<16),r=n>8388608?n-16777216:n;return t+=3,r<0?r/8388608:r/8388607},pcm24s:function(){var n=e.getUint8(t+0)+(e.getUint8(t+1)<<8)+(e.getUint8(t+2)<<16);return t+=3,(n>8388608?n-16777216:n)/8388608},pcm32:function(){var n=e.getInt32(t,!0);return t+=4,n<0?n/2147483648:n/2147483647},pcm32s:function(){var n=e.getInt32(t,!0);return t+=4,n/2147483648},pcm32f:function(){var n=e.getFloat32(t,!0);return t+=4,n},pcm64f:function(){var n=e.getFloat64(t,!0);return t+=8,n}}}(new DataView(t));if("RIFF"!==r.string(4))throw new TypeError("Invalid WAV file");if(r.uint32(),"WAVE"!==r.string(4))throw new TypeError("Invalid WAV file");var a=null,s=null;do{var u=r.string(4),c=r.uint32();switch(u){case"fmt ":if((a=o(r,c))instanceof Error)throw a;break;case"data":if((s=i(r,c,a,n))instanceof Error)throw s;break;default:r.skip(c)}}while(null===s);return s}function o(e,t){var r=e.uint16();if(!n.hasOwnProperty(r))return new TypeError("Unsupported format in WAV file: 0x"+r.toString(16));var o={formatId:r,floatingPoint:3===r,numberOfChannels:e.uint16(),sampleRate:e.uint32(),byteRate:e.uint32(),blockSize:e.uint16(),bitDepth:e.uint16()};return e.skip(t-16),o}function i(e,t,n,r){t=Math.min(t,e.remain());for(var o=Math.floor(t/n.blockSize),i=n.numberOfChannels,a=n.sampleRate,s=new Array(i),u=0;u<i;u++)s[u]=new Float32Array(o);var c=function(e,t,n,r,o){var i=r.bitDepth,a=r.floatingPoint?"f":o.symmetric?"s":"",s="pcm"+i+a;if(!e[s])return new TypeError("Not supported bit depth: "+r.bitDepth);for(var u=e[s].bind(e),c=r.numberOfChannels,f=0;f<n;f++)for(var l=0;l<c;l++)t[l][f]=u();return null}(e,s,o,n,r);return c instanceof Error?c:{numberOfChannels:i,length:o,sampleRate:a,channelData:s}}t.exports.decode=function(e,t){return new Promise((function(n){n(r(e,t))}))},t.exports.decode.sync=r}).call(this)}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],29:[function(e,t,n){"use strict";var r=e("global/window"),o=e("is-function"),i=e("parse-headers"),a=e("xtend");function s(e,t,n){var r=e;return o(t)?(n=t,"string"==typeof e&&(r={uri:e})):r=a(t,{uri:e}),r.callback=n,r}function u(e,t,n){return c(t=s(e,t,n))}function c(e){if(void 0===e.callback)throw new Error("callback argument missing");var t=!1,n=function(n,r,o){t||(t=!0,e.callback(n,r,o))};function r(){var e=void 0;if(e=f.response?f.response:f.responseText||function(e){try{if("document"===e.responseType)return e.responseXML;if(""===e.responseType&&!(e.responseXML&&"parsererror"===e.responseXML.documentElement.nodeName))return e.responseXML}catch(e){}return null}(f),y)try{e=JSON.parse(e)}catch(e){}return e}function o(e){return clearTimeout(l),e instanceof Error||(e=new Error(""+(e||"Unknown XMLHttpRequest Error"))),e.statusCode=0,n(e,v)}function a(){if(!c){var t;clearTimeout(l);var o=v,a=null;return 0!==(t=e.useXDR&&void 0===f.status?200:1223===f.status?204:f.status)?(o={body:r(),statusCode:t,method:d,headers:{},url:p,rawRequest:f},f.getAllResponseHeaders&&(o.headers=i(f.getAllResponseHeaders()))):a=new Error("Internal XMLHttpRequest Error"),n(a,o,o.body)}}var s,c,f=e.xhr||null;f||(f=e.cors||e.useXDR?new u.XDomainRequest:new u.XMLHttpRequest);var l,p=f.url=e.uri||e.url,d=f.method=e.method||"GET",h=e.body||e.data,m=f.headers=e.headers||{},g=!!e.sync,y=!1,v={body:void 0,headers:{},statusCode:0,method:d,url:p,rawRequest:f};if("json"in e&&!1!==e.json&&(y=!0,m.accept||m.Accept||(m.Accept="application/json"),"GET"!==d&&"HEAD"!==d&&(m["content-type"]||m["Content-Type"]||(m["Content-Type"]="application/json"),h=JSON.stringify(!0===e.json?h:e.json))),f.onreadystatechange=function(){4===f.readyState&&setTimeout(a,0)},f.onload=a,f.onerror=o,f.onprogress=function(){},f.onabort=function(){c=!0},f.ontimeout=o,f.open(d,p,!g,e.username,e.password),g||(f.withCredentials=!!e.withCredentials),!g&&e.timeout>0&&(l=setTimeout((function(){if(!c){c=!0,f.abort("timeout");var e=new Error("XMLHttpRequest timeout");e.code="ETIMEDOUT",o(e)}}),e.timeout)),f.setRequestHeader)for(s in m)m.hasOwnProperty(s)&&f.setRequestHeader(s,m[s]);else if(e.headers&&!function(e){for(var t in e)if(e.hasOwnProperty(t))return!1;return!0}(e.headers))throw new Error("Headers cannot be set on an XDomainRequest object");return"responseType"in e&&(f.responseType=e.responseType),"beforeSend"in e&&"function"==typeof e.beforeSend&&e.beforeSend(f),f.send(h||null),f}t.exports=u,t.exports.default=u,u.XMLHttpRequest=r.XMLHttpRequest||function(){},u.XDomainRequest="withCredentials"in new u.XMLHttpRequest?u.XMLHttpRequest:r.XDomainRequest,function(e,t){for(var n=0;n<e.length;n++)t(e[n])}(["get","put","post","patch","head","delete"],(function(e){u["delete"===e?"del":e]=function(t,n,r){return(n=s(t,n,r)).method=e.toUpperCase(),c(n)}}))},{"global/window":18,"is-function":19,"parse-headers":27,xtend:30}],30:[function(e,t,n){t.exports=function(){for(var e={},t=0;t<arguments.length;t++){var n=arguments[t];for(var o in n)r.call(n,o)&&(e[o]=n[o])}return e};var r=Object.prototype.hasOwnProperty},{}],31:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.createAnalyser=function(e,t){const n=e/2,r=new Float32Array(e);let a={real:new Float32Array(e),imag:new Float32Array(e)};const s=new Float32Array(e);return{get(u,f){const l=u.length;if(l!==e)throw new Error("expected timeDomainData to match fftSize");if(f.length!==n)throw new Error("expected output to match frequencyBinCount");!function(e,t){const n=e.length,r=.16,a=(1-r)/2,s=.5,u=r/2;for(var c=0;c<n;c++)t[c]=(a-s*Math.cos(o*c/n)+u*Math.cos(i*c/n))*e[c]}(u,r),a.real.set(r),a.imag.fill(0);const p=c(a),d=p.real,h=p.imag;a=p;const m=t>0;for(let e=0;e<n;e++){let n=d[e],r=h[e],o=Math.sqrt(n*n+r*r)/l;m&&(o=t*s[e]+(1-t)*Math.abs(o)),s[e]=o,f[e]=20*Math.log10(o)}return f}}};var r={};const o=2*Math.PI,i=4*Math.PI;let a=function(e,t){return{real:e.real+t.real,imag:e.imag+t.imag}},s=function(e,t){return{real:e.real-t.real,imag:e.imag-t.imag}},u=function(e,t){let n=-o*e/t;return{real:Math.cos(n),imag:Math.sin(n)}},c=function(e){let t=e;const n=t.real.length,o=Math.log2(n);if(Math.round(o)!=o)throw new Error("Input size must be a power of 2.");if(t.real.length!=t.imag.length)throw new Error("Real and imaginary components must have the same length.");const i=function(e){if(void 0===r[e]){let t=(e-1).toString(2).length,n="0".repeat(t),o={};for(let t=0;t<e;t++){let e=t.toString(2);e=n.slice(e.length)+e,e=[...e].reverse().join(""),o[t]=parseInt(e,2)}r[e]=o}return r[e]}(n);let c={real:[],imag:[]};for(let e=0;e<n;e++)c.real[i[e]]=t.real[e],c.imag[i[e]]=t.imag[e];for(let e=0;e<n;e++)t.real[e]=c.real[e],t.imag[e]=c.imag[e];for(let e=1;e<=o;e++){let r=Math.pow(2,e);for(let e=0;e<r/2;e++){let o=u(e,r);for(let i=0;i<n/r;i++){let n=r*i+e,u=r*i+e+r/2,c={real:t.real[n],imag:t.imag[n]},p={real:(f=o).real*(l={real:t.real[u],imag:t.imag[u]}).real-f.imag*l.imag,imag:f.real*l.imag+f.imag*l.real},d=s(c,p);t.real[u]=d.real,t.imag[u]=d.imag;let h=a(p,c);t.real[n]=h.real,t.imag[n]=h.imag}}}var f,l;return t}},{}],32:[function(e,t,n){"use strict";var r=l(e("wav-decoder")),o=e("./fft/index.js"),i=l(e("canvas-sketch")),a=f(e("canvas-sketch-util/math")),s=(f(e("canvas-sketch-util/color")),l(e("audio-frequency-to-index"))),u=l(e("load-asset"));function c(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(c=function(e){return e?n:t})(e)}function f(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var n=c(t);if(n&&n.has(e))return n.get(e);var r={},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var i in e)if("default"!==i&&Object.prototype.hasOwnProperty.call(e,i)){var a=o?Object.getOwnPropertyDescriptor(e,i):null;a&&(a.get||a.set)?Object.defineProperty(r,i,a):r[i]=e[i]}return r.default=e,n&&n.set(e,r),r}function l(e){return e&&e.__esModule?e:{default:e}}class p{constructor(e){this.context=e,this._bufferSource=new AudioBufferSourceNode(e),this._splitter=new ChannelSplitterNode(e),this._out=new ChannelMergerNode(e),this._sampleHolder=new Float32Array(1)}update(){return this._analyser&&this._analyser.getFloatTimeDomainData(this._sampleHolder),this._sampleHolder[0]}get playbackPosition(){return this._sampleHolder[0]}set buffer(e){this._bufferSource.buffer=new AudioBuffer({length:e.length,sampleRate:e.sampleRate,numberOfChannels:e.numberOfChannels+1});for(let t=0;t<e.numberOfChannels;t++)this._bufferSource.buffer.copyToChannel(e.getChannelData(t),t);for(let t=0;t<e.length;t++)this._bufferSource.buffer.getChannelData(e.numberOfChannels)[t]=t/e.length;this._bufferSource.connect(this._splitter);for(let t=0;t<e.numberOfChannels;t++)this._splitter.connect(this._out,t,t);this._analyser=new AnalyserNode(this.context),this._analyser.smoothingTimeConstant=0,this._splitter.connect(this._analyser,e.numberOfChannels)}get loop(){return this._bufferSource.loop}set loop(e){this._bufferSource.loop=e}get playbackRate(){return this._bufferSource.playbackRate}start(...e){this._bufferSource.start(...e)}connect(...e){this._out.connect(...e)}stop(...e){this._bufferSource.stop()}disconnect(...e){this._out.disconnect(...e)}}async function d(e){const{data:t={},context:n}=e,{imageSrc:i,audioSrc:c}=t,f=await(await fetch(c)).arrayBuffer(),l=await(0,u.default)(i),d=await r.default.decode(f),{sampleRate:h,channelData:m}=d,g=d.length,y=d.channelData[0];console.log(`Loaded audio sample ${c}, ${g/h} seconds`);const v=2048,b=new Float32Array(1024),w=b.length,x=(0,s.default)(18e3,h,w),M=n.createImageData(32,w);let k;k=Array(256).fill().map(((e,t)=>[t,t,t]));const _=2048,T=x;e.update({dimensions:[_,T]}),console.log(_,T),n.drawImage(l,0,0,_,T);const E=(0,o.createAnalyser)(v,0);let j,R,P,O=!1;return{render:({context:t,width:n,height:r})=>{if(!P)return;if(O)return void e.pause();P.update();const o=P.playbackPosition,i=a.clamp(Math.round(o*g),0,g-1),s=i/h;Math.floor(s),Math.min(n,r);let u=y.slice(i,i+v);u.length!==v&&(u=new Float32Array(v),u.set(u),O=!0),E.get(u,b),t.save(),S(o,i,b),t.restore()},startAudio:function(){if(n.clearRect(0,0,_,T),j||(j=new AudioContext),!R){R=j.createBuffer(m.length,g,h);for(let e=0;e<m.length;e++)R.copyToChannel(m[e],e)}P&&(P.stop(),P.disconnect()),P=new p(j),P.buffer=R,P.loop=!1,P.connect(j.destination),P.start(j.currentTime),e.play(),O=!1}};function S(e,t,r){const o=M.data;for(let e=0;e<r.length;e++){const t=a.clamp01(a.inverseLerp(-120,-70,r[e])),n=a.lerpFrames(k,t);for(let t=0;t<M.width;t++){const r=t+(T-e-1)*M.width;o[4*r+0]=n[0],o[4*r+1]=n[1],o[4*r+2]=n[2],o[4*r+3]=255}}const i=Math.floor(e*_);n.putImageData(M,i,0)}}const h={dimensions:[2048,836],playing:!1,animate:!0};window.naturalRadioPlayer=window.naturalRadioPlayer||{};const{imageSrc:m="spectrum.png",audioSrc:g="seoulmono.wav",autoLoad:y=!0}=window.naturalRadioPlayer;naturalRadioPlayer.mount=()=>(0,i.default)(d,{...h,...window.naturalRadioPlayer.settings,data:{imageSrc:m,audioSrc:g}}),window.naturalRadioPlayer.onReady&&window.naturalRadioPlayer.onReady(window.naturalRadioPlayer),y&&(async()=>{const e=await naturalRadioPlayer.mount();window.addEventListener("click",(()=>e.sketch.startAudio()))})()},{"./fft/index.js":31,"audio-frequency-to-index":1,"canvas-sketch":13,"canvas-sketch-util/color":4,"canvas-sketch-util/math":12,"load-asset":21,"wav-decoder":28}],33:[function(e,t,n){(function(e){(function(){e.CANVAS_SKETCH_DEFAULT_STORAGE_KEY=window.location.href}).call(this)}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}]},{},[32,33]);
//# sourceMappingURL=spectrum.js.map
